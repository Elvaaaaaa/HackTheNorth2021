data = [('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610874477, 1610874485), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – main.py', 'pycharm64.exe', 1610874485, 1610874486), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Task Switching', 'explorer.exe', 1610874486, 1610874487), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610874515, 1610874534), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – main.py', 'pycharm64.exe', 1610874534, 1610874535), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610874535, 1610874540), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – main.py', 'pycharm64.exe', 1610874540, 1610874546), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610874625, 1610874634), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Task Switching', 'explorer.exe', 1610874634, 1610874635), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – main.py', 'pycharm64.exe', 1610874635, 1610874638), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610874638, 1610874644), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Skype', 'Skype.exe', 1610874644, 1610874678), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – main.py', 'pycharm64.exe', 1610874678, 1610874746), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610874746, 1610874755), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – main.py', 'pycharm64.exe', 1610874755, 1610874760), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Task Switching', 'explorer.exe', 1610874760, 1610874761), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'New Tab - Google Chrome', 'chrome.exe', 1610874761, 1610874765), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'css transition hover - Google Search - Google Chrome', 'chrome.exe', 1610874765, 1610874766), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'How To - Transition on Hover - Google Chrome', 'chrome.exe', 1610874766, 1610874777), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Tryit Editor v3.6 - Google Chrome', 'chrome.exe', 1610874777, 1610874783), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – main.py', 'pycharm64.exe', 1610874783, 1610874802), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Tryit Editor v3.6 - Google Chrome', 'chrome.exe', 1610874802, 1610874804), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', '', 'explorer.exe', 1610874804, 1610874805), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610874808, 1610874812), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610874969, 1610875002), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Search', 'SearchApp.exe', 1610875002, 1610875003), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Snipping Tool', 'SnippingTool.exe', 1610875003, 1610875005), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610875106, 1610875171), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', '[#] CockroachDB CCL v20.2.2 : TLSv1.2 : New Connection : defaultdb [#]', 'TablePlus.exe', 1610875171, 1610875173), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', '[#] CockroachDB CCL v20.2.2 : TLSv1.2 : New Connection : defaultdb : public.andr_tracking [#]', 'TablePlus.exe', 1610875173, 1610875174), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', '[#] CockroachDB CCL v20.2.2 : TLSv1.2 : New Connection : defaultdb : public.andr_groups [#]', 'TablePlus.exe', 1610875174, 1610875184), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', '[#] CockroachDB CCL v20.2.2 : TLSv1.2 : New Connection : defaultdb : public.andr_users [#]', 'TablePlus.exe', 1610875184, 1610875186), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', '[#] CockroachDB CCL v20.2.2 : TLSv1.2 : New Connection : defaultdb : public.andr_groups [#]', 'TablePlus.exe', 1610875186, 1610875196), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Skype', 'Skype.exe', 1610875196, 1610875197), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610875204, 1610875210), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Skype', 'Skype.exe', 1610875210, 1610875216), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610875216, 1610875219), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Skype', 'Skype.exe', 1610875219, 1610875224), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610875224, 1610875247), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610875257, 1610875308), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Task Switching', 'explorer.exe', 1610875308, 1610875311), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Tryit Editor v3.6 - Google Chrome', 'chrome.exe', 1610875311, 1610875312), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'How To - Transition on Hover - Google Chrome', 'chrome.exe', 1610875312, 1610875313), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Snipping Tool', 'SnippingTool.exe', 1610875350, 1610875351), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', '', 'SnippingTool.exe', 1610875351, 1610875352), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Snipping Tool', 'SnippingTool.exe', 1610875352, 1610875360), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Skype', 'Skype.exe', 1610875360, 1610875364), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Search', 'SearchApp.exe', 1610875364, 1610875365), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Untitled - Paint', 'mspaint.exe', 1610875365, 1610875368), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Snipping Tool', 'SnippingTool.exe', 1610875368, 1610875369), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Untitled - Paint', 'mspaint.exe', 1610875369, 1610875425), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Paint', 'mspaint.exe', 1610875425, 1610875426), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610875437, 1610875458), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Search', 'SearchApp.exe', 1610875458, 1610875459), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Snipping Tool', 'SnippingTool.exe', 1610875459, 1610875463), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Task Switching', 'explorer.exe', 1610875463, 1610875464), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610875464, 1610875465), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Snipping Tool', 'SnippingTool.exe', 1610875465, 1610875467), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Search', 'SearchApp.exe', 1610875467, 1610875468), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Untitled - Paint', 'mspaint.exe', 1610875468, 1610875653), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Paint', 'mspaint.exe', 1610875653, 1610875654), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Snipping Tool', 'SnippingTool.exe', 1610875654, 1610875656), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Task Switching', 'explorer.exe', 1610875656, 1610875657), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', '', 'explorer.exe', 1610875704, 1610875705), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610875705, 1610875706), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Snipping Tool', 'SnippingTool.exe', 1610875706, 1610875707), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Task Switching', 'explorer.exe', 1610875707, 1610875709), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610875709, 1610875711), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'GUI - Google Chrome', 'chrome.exe', 1610875711, 1610875712), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610875712, 1610875714), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Search', 'SearchApp.exe', 1610875714, 1610875715), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Snipping Tool', 'SnippingTool.exe', 1610875715, 1610875717), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', '', 'SnippingTool.exe', 1610875717, 1610875718), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Snipping Tool', 'SnippingTool.exe', 1610875718, 1610875720), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Paint', 'mspaint.exe', 1610875720, 1610875721), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Snipping Tool', 'SnippingTool.exe', 1610875721, 1610875723), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Task Switching', 'explorer.exe', 1610875723, 1610875724), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'GUI - Google Chrome', 'chrome.exe', 1610875724, 1610875725), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Untitled - Paint', 'mspaint.exe', 1610875725, 1610875879), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Task Switching', 'explorer.exe', 1610875879, 1610875881), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610875881, 1610875935), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Task Switching', 'explorer.exe', 1610875935, 1610875936), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Untitled - Paint', 'mspaint.exe', 1610875936, 1610875949), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – main.py', 'pycharm64.exe', 1610875949, 1610875954), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', '', 'explorer.exe', 1610875954, 1610875955), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610875982, 1610875998), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', '[#] Qt Designer [#]', 'designer.exe', 1610875998, 1610876005), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Task Switching', 'explorer.exe', 1610876005, 1610876006), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – main.py', 'pycharm64.exe', 1610876006, 1610876019), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', '[#] Qt Designer [#]', 'designer.exe', 1610876019, 1610876022), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – main.py', 'pycharm64.exe', 1610876022, 1610876024), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', '[#] Qt Designer [#]', 'designer.exe', 1610876024, 1610876027), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – main.py', 'pycharm64.exe', 1610876027, 1610876031), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', '[#] Qt Designer [#]', 'designer.exe', 1610876031, 1610876032), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Task Switching', 'explorer.exe', 1610876096, 1610876099), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610876368, 1610876383), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – ui_main.py', 'pycharm64.exe', 1610876383, 1610876385), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610876412, 1610876416), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Skype', 'Skype.exe', 1610876416, 1610876417), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610876417, 1610876420), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – main.py', 'pycharm64.exe', 1610876420, 1610876422), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Skype', 'Skype.exe', 1610876422, 1610876424), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – main.py', 'pycharm64.exe', 1610876424, 1610876427), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610876427, 1610876439), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – main.py', 'pycharm64.exe', 1610876439, 1610876441), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610876441, 1610876443), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Task Switching', 'explorer.exe', 1610876443, 1610876446), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610876446, 1610876455), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Skype', 'Skype.exe', 1610876455, 1610876457), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610876457, 1610876472), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – Analysis.py', 'pycharm64.exe', 1610876472, 1610876474), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610876474, 1610876475), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – Analysis.py', 'pycharm64.exe', 1610876475, 1610876477), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610877150, 1610877189), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – Analysis.py', 'pycharm64.exe', 1610877189, 1610877192), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610877192, 1610877201), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – Cockroach.py', 'pycharm64.exe', 1610877201, 1610877225), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – ui_main.py', 'pycharm64.exe', 1610877225, 1610877227), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – Analysis.py', 'pycharm64.exe', 1610877227, 1610877228), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610877228, 1610877234), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610877332, 1610877338), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'HackTheNorth2021 – Analysis.py', 'pycharm64.exe', 1610877338, 1610877340), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610877340, 1610877419), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Search', 'SearchApp.exe', 1610877419, 1610877420), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Calculator', 'ApplicationFrameHost.exe', 1610877420, 1610877423), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'MainWindow', 'python.exe', 1610877423, 1610877451), ('dc8448c4-583c-11eb-a227-8c8caa42b62e', 'anzhui', 'Skype', 'Skype.exe', 1610877451, 1610877467), ('bb1d4ef5-58aa-11eb-8417-8c8caa42b62e', 'shabi', 'MainWindow', 'python.exe', 1610877630, 1610877632), ('bb1d4ef5-58aa-11eb-8417-8c8caa42b62e', 'shabi', 'HackTheNorth2021 – config.json', 'pycharm64.exe', 1610877632, 1610877634), ('bb1d4ef5-58aa-11eb-8417-8c8caa42b62e', 'shabi', 'Skype', 'Skype.exe', 1610877634, 1610877637), ('bb1d4ef5-58aa-11eb-8417-8c8caa42b62e', 'shabi', 'HackTheNorth2021 – config.json', 'pycharm64.exe', 1610877637, 1610877638)]

class Analysis:
    @staticmethod
    def find(tracking_data, program_keys):
        filtered = {}
        for search in program_keys:
            for item in tracking_data:
                if str(item[1]) not in filtered.keys():
                    filtered[str(item[1])] = []

                if search in item:
                    found = next((x for x in filtered[str(item[1])] if x['name'] == search), None)
                    if found is None:
                        filtered[str(item[1])].append({"name": search, "time": item[5] - item[4]})
                    else:
                        found["time"] = found['time'] + item[5] - item[4]

        return filtered

    @staticmethod
    def time_sum(data):
        out = {}
        for key in data.keys():
            total = 0
            for item in data[key]:
                total += item['time']
            out[key] = total
        return out

    @staticmethod
    def sort(data):
        return dict(sorted(data.items(), key=lambda item: item[1], reverse=True))

    @staticmethod
    def convert_time(seconds):
        hours = seconds // 3600
        minute = (seconds - hours * 3600) // 60

        return str(hours) + "h " + str(minute) + "m " + str(seconds % 60) + "s"

    @staticmethod
    def convert_time_dict(data):
        return dict(map(lambda kv: (kv[0], Analysis.convert_time(kv[1])), data.items()))

    @staticmethod
    def get_average(data):
        sum = 0
        for keys in data:
            sum += data[keys]
        return str(Analysis.convert_time(int(sum / len(data))))


# print(Analysis.find(data, ['Skype.exe', 'chrome.exe', "python.exe"]))
# print(time_sum(find(data, ['Skype.exe', 'chrome.exe', "python.exe"])))
# print(sort(time_sum(find(data, ['Skype.exe', 'chrome.exe', "python.exe"]))))
print(Analysis.sort(Analysis.time_sum(Analysis.find(data, ['Skype.exe', 'chrome.exe', "python.exe"]))))
print(Analysis.convert_time_dict(Analysis.sort(Analysis.time_sum(Analysis.find(data, ['Skype.exe', 'chrome.exe', "python.exe"])))))